{"ast":null,"code":"import _regeneratorRuntime from \"/home/pandi95/Projects/React/blog-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/pandi95/Projects/React/blog-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { Field, reduxForm, getFormValues } from 'redux-form';\nimport { loginUser as _loginUser, logoutUser as _logoutUser, getUserData as _getUserData } from \"../../../actions/auth/authAction\";\nimport { toastify } from \"../../../components/Toast/Toastify\";\nimport TextInput from \"../../../components/Form/Input\";\nimport { getMy } from \"../../../actions/foodcourt/foodCourtAction\";\nimport { GUARD_OWNER } from \"../../../constants\";\nvar styles = {\n  formContent: {\n    marginTop: '50px'\n  },\n  content: {\n    paddingTop: '40px'\n  }\n};\n\nvar Register = function Register(_ref) {\n  var invalid = _ref.invalid,\n      submitting = _ref.submitting,\n      handleSubmit = _ref.handleSubmit,\n      loginUser = _ref.loginUser,\n      getUserData = _ref.getUserData,\n      getMyFoodcourt = _ref.getMyFoodcourt;\n  var history = useHistory();\n\n  var onSubmit = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(values) {\n      var result, resUser, resFood;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              console.log('Values ', values);\n              console.log('submit ', submitting, invalid);\n              _context.next = 4;\n              return loginUser({\n                username: values.email,\n                password: values.password\n              }, GUARD_OWNER);\n\n            case 4:\n              result = _context.sent;\n              console.log('RESPONSE USER ', result);\n\n              if (!result.success) {\n                _context.next = 27;\n                break;\n              }\n\n              _context.next = 9;\n              return getUserData(GUARD_OWNER);\n\n            case 9:\n              resUser = _context.sent;\n\n              if (!resUser.success) {\n                _context.next = 24;\n                break;\n              }\n\n              if (!(resUser.data && resUser.data.roleId === 3)) {\n                _context.next = 20;\n                break;\n              }\n\n              toastify({\n                type: 'success',\n                message: result.meta.message\n              });\n              _context.next = 15;\n              return getMyFoodcourt({\n                isAll: 1\n              });\n\n            case 15:\n              resFood = _context.sent;\n              console.log('GET MY FOOD COURT ', resFood);\n\n              if (resFood.success && resFood.data && resFood.data.length > 0) {\n                history.push('/owner/select-foodcourt');\n              } else {\n                history.push('/owner/register-foodcourt');\n              }\n\n              _context.next = 22;\n              break;\n\n            case 20:\n              _logoutUser(GUARD_OWNER);\n\n              toastify({\n                type: 'error',\n                message: 'Unauthenticated'\n              });\n\n            case 22:\n              _context.next = 25;\n              break;\n\n            case 24:\n              toastify({\n                type: 'error',\n                message: 'Login Error'\n              });\n\n            case 25:\n              _context.next = 28;\n              break;\n\n            case 27:\n              toastify({\n                type: 'error',\n                message: result.message\n              });\n\n            case 28:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function onSubmit(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: \"row owner-container\"\n  }, __jsx(\"div\", {\n    className: \"col s12 m7 l7 cover-image\"\n  }, __jsx(\"img\", {\n    className: \"image\",\n    src: \"static/Image/fcm-cover.jpg\",\n    alt: \"\"\n  })), __jsx(\"div\", {\n    className: \"col s12 m5 l5 content\",\n    style: styles.content\n  }, __jsx(\"h4\", null, \"Masuk ke Akun Kamu\"), __jsx(\"p\", null, \"Segera daftarkan foodcourt kamu, dan segera bergabung bersama kami dalam meningkatkan pelayanan foodcourt kamu\"), __jsx(\"div\", {\n    className: \"form-content\",\n    style: styles.formContent\n  }, __jsx(\"form\", {\n    onSubmit: handleSubmit(onSubmit)\n  }, __jsx(Field, {\n    id: \"email\",\n    name: \"email\",\n    label: \"Email\",\n    type: \"email\",\n    component: TextInput\n  }), __jsx(Field, {\n    id: \"password\",\n    name: \"password\",\n    label: \"Kata Sandi\",\n    type: \"password\",\n    component: TextInput\n  }), __jsx(\"div\", {\n    className: \"button-login\"\n  }, __jsx(\"button\", {\n    disabled: invalid || submitting,\n    className: \"waves-effect waves-light btn btn-app bg-pimary\"\n  }, \"Masuk\"), __jsx(\"div\", {\n    className: \"forgot-password\"\n  }, __jsx(\"span\", null, \"Belum punya akun ? \"), __jsx(Link, {\n    to: \"/owner/register\",\n    className: \"color-primary waves-effect\"\n  }, \"Daftar Sekarang\"))))))));\n};\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    values: getFormValues('FormRegisterOwner')(state)\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    loginUser: function loginUser(data, guard) {\n      return dispatch(_loginUser(data, guard));\n    },\n    getUserData: function getUserData(guard) {\n      return dispatch(_getUserData(guard));\n    },\n    logoutUser: function logoutUser(guard) {\n      return dispatch(_logoutUser(guard));\n    },\n    getMyFoodcourt: function getMyFoodcourt(data) {\n      return dispatch(getMy(data));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(reduxForm({\n  form: 'FormRegisterOwner' // validate\n\n})(Register));","map":null,"metadata":{},"sourceType":"module"}